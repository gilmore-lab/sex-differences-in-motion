<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Rick O. Gilmore &amp; Yiming Qian" />


<title>Sex differences in experienced optic flow</title>

<script src="sex-diffs-in-flow_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="sex-diffs-in-flow_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="sex-diffs-in-flow_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="sex-diffs-in-flow_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="sex-diffs-in-flow_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="sex-diffs-in-flow_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="sex-diffs-in-flow_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="sex-diffs-in-flow_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="sex-diffs-in-flow_files/navigation-1.1/tabsets.js"></script>
<script src="sex-diffs-in-flow_files/navigation-1.1/codefolding.js"></script>
<link href="sex-diffs-in-flow_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="sex-diffs-in-flow_files/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>



<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Sex differences in experienced optic flow</h1>
<h4 class="author">Rick O. Gilmore &amp; Yiming Qian</h4>
<h4 class="date">2019-04-12 13:19:10</h4>

</div>


<div id="background" class="section level1">
<h1><span class="header-section-number">1</span> Background</h1>
<p>This document analyzes natural optic flow data drawn from</p>
<p>Jayaraman, S., Smith, L.B., Raudies, F. &amp; Gilmore, R.O. (2014). Natural Scene Statistics of Visual Experience Across Development and Culture. Databrary. Retrieved April 5, 2019 from <a href="http://doi.org/10.17910/B7988V" class="uri">http://doi.org/10.17910/B7988V</a>.</p>
<p>Infants from India and the U.S. wore a head-mounted camera for several hours during one day. Jayaraman et al. used computer vision techniques to extract optic flow patterns and speeds from the videos.</p>
<p>Here, we analyze the data to determine whether there is evidence for sex differences in the speeds of experienced optic flow.</p>
</div>
<div id="data-gathering" class="section level1">
<h1><span class="header-section-number">2</span> Data gathering</h1>
<p>We lightly modified data stored elsewhere and uploaded them to the Jayaraman et al. Databrary volume.</p>
<p>The (CSV format) data files are in a <code>materials</code> folder <a href="https://nyu.databrary.org/volume/81/slot/35545/-" class="uri">https://nyu.databrary.org/volume/81/slot/35545/-</a></p>
<div id="work-plan" class="section level2">
<h2><span class="header-section-number">2.1</span> Work plan</h2>
<p>We will do the following:</p>
<ol style="list-style-type: decimal">
<li>Import the CSVs as data frames using the <code>databraryapi::read_csv_data_as_df()</code> command from the <code>databraryapi</code> package. The package can be found at <a href="https://github.com/PLAY-behaviorome/databraryapi" class="uri">https://github.com/PLAY-behaviorome/databraryapi</a>.</li>
<li>Import the Databrary participant metadata spreadsheet using the <code>databraryapi::download_session_csv()</code> command from the <code>databraryapi</code> package.</li>
<li>Merge the spreadsheet data with the optic flow data files, one by one, using <code>dplyr</code> commands.</li>
</ol>
<p><strong>Note:</strong>The <code>setup</code> chunk should load the <code>databraryapi</code> package. If you are not Rick Gilmore, you will need to render this document from an RStudio console as follows: <code>rmarkdown::render('sex-diffs-in-flow.Rmd', params = list(db_login=&lt;YOUREMAIL@YOURDOMAIN&gt;))</code>, where you substitute your Databrary account ID (email) for <code>&lt;YOUREMAIL@YOURDOMAIN&gt;</code>.</p>
</div>
<div id="import-optic-flow-csvs" class="section level2">
<h2><span class="header-section-number">2.2</span> Import optic flow CSVs</h2>
<p>List the CSVs before we import them. But first, let’s assign the <code>vol_id</code> and <code>session_id</code> variables.</p>
<pre class="r"><code>vol_id &lt;- 81
session_id = 35545
databraryapi::list_assets_in_session(vol_id, session_id)</code></pre>
<pre><code>##   asset_id asset_type_id classification                   name permission
## 1   165805             2              3 pattern_histogram_bins          1
## 2   165804             2              3   speed_histogram_bins          1
## 3   165803             2              3   speed_histogram_fits          1
##     size vol_id session_id mimetype extension             asset_type
## 1 581820     81      35545 text/csv       csv Comma-separated values
## 2 221418     81      35545 text/csv       csv Comma-separated values
## 3   2377     81      35545 text/csv       csv Comma-separated values
##   transcodable
## 1           NA
## 2           NA
## 3           NA</code></pre>
<p>Isn’t reproducible science fun?</p>
<p>Now, we import these files noting the <code>asset_id</code> values from the table. We do this one at a time so we can confirm everything is working.</p>
<pre class="r"><code>patt_hist &lt;- databraryapi::read_csv_data_as_df(session_id, asset_id = 165805)
str(patt_hist)</code></pre>
<pre><code>## &#39;data.frame&#39;:    13200 obs. of  9 variables:
##  $ ID            : Factor w/ 22 levels &quot;006AP&quot;,&quot;006MO&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ video         : int  5 5 5 5 4 4 4 4 4 4 ...
##  $ motion_status : Factor w/ 2 levels &quot;Moving&quot;,&quot;Stationary&quot;: 2 2 2 2 2 2 2 2 1 1 ...
##  $ pattern_type  : Factor w/ 4 levels &quot;cw&quot;,&quot;exp&quot;,&quot;left&quot;,..: 2 1 3 4 2 1 3 4 2 1 ...
##  $ start_fr      : int  48162 48162 48162 48162 34106 34106 34106 34106 30839 30839 ...
##  $ end_fr        : int  48312 48312 48312 48312 34256 34256 34256 34256 30989 30989 ...
##  $ n_frames      : int  150 150 150 150 150 150 150 150 150 150 ...
##  $ corr_bin_ctr  : num  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...
##  $ corr_bin_count: int  0 0 36 36 0 0 8 8 0 1 ...</code></pre>
<pre class="r"><code>spd_bins &lt;- databraryapi::read_csv_data_as_df(session_id, asset_id = 165804)
str(spd_bins)</code></pre>
<pre><code>## &#39;data.frame&#39;:    4444 obs. of  7 variables:
##  $ ID           : Factor w/ 22 levels &quot;006AP&quot;,&quot;006MO&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ chi_square   : num  2.31e+09 2.31e+09 2.31e+09 2.31e+09 2.31e+09 ...
##  $ df           : int  100 100 100 100 100 100 100 100 100 100 ...
##  $ p_val        : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ speed_deg_sec: int  0 0 1 1 2 2 3 3 4 4 ...
##  $ motion_status: Factor w/ 2 levels &quot;Moving&quot;,&quot;Stationary&quot;: 1 2 1 2 1 2 1 2 1 2 ...
##  $ n_obs        : int  339284550 405637124 9559350 275088034 19301100 336266775 31789950 280387963 35419650 198584720 ...</code></pre>
<pre class="r"><code>spd_fits &lt;- databraryapi::read_csv_data_as_df(session_id, asset_id = 165803)
str(spd_fits)</code></pre>
<pre><code>## &#39;data.frame&#39;:    44 obs. of  12 variables:
##  $ ID           : Factor w/ 22 levels &quot;006AP&quot;,&quot;006MO&quot;,..: 1 1 2 2 3 3 4 4 5 5 ...
##  $ mean_speed   : num  19.7 37.8 31.4 29.5 18.8 ...
##  $ median_spd   : int  15 44 34 30 16 42 39 13 40 25 ...
##  $ alpha        : num  0.85 0.97 0.86 0.89 0.76 0.75 0.82 0.68 0.85 0.85 ...
##  $ kappa        : num  1.01 2.19 2.62 1.38 1.25 1.86 1.82 1.01 2 1.26 ...
##  $ theta        : num  17.4 26.5 15.1 31.2 15.8 ...
##  $ r2           : num  0.98 0.93 0.99 0.99 0.98 0.97 0.9 0.95 0.94 0.99 ...
##  $ motion_status: Factor w/ 2 levels &quot;Moving&quot;,&quot;Stationary&quot;: 2 1 1 2 1 2 1 2 1 2 ...
##  $ p05          : int  1 1 0 0 1 1 1 1 1 1 ...
##  $ p01          : int  1 1 0 0 1 1 1 1 1 1 ...
##  $ p005         : int  1 1 0 0 1 1 1 1 1 1 ...
##  $ p0001        : int  1 1 0 0 1 1 1 1 0 0 ...</code></pre>
<p>This is looking good.</p>
</div>
<div id="import-participant-data" class="section level2">
<h2><span class="header-section-number">2.3</span> Import participant data</h2>
<pre class="r"><code>databraryapi::login_db(params$db_account)</code></pre>
<pre><code>## Login successful.</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="r"><code>participants &lt;- databraryapi::download_session_csv(vol_id)
str(participants)</code></pre>
<pre><code>## &#39;data.frame&#39;:    84 obs. of  12 variables:
##  $ session_id           : int  7577 7578 7580 7581 7583 7584 7587 7588 7589 7699 ...
##  $ session_name         : Factor w/ 4 levels &quot;&quot;,&quot;ICDL-EpiRob-15&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ session_date         : Factor w/ 53 levels &quot;&quot;,&quot;2012-04-07&quot;,..: 21 20 20 19 19 20 20 21 21 20 ...
##  $ session_release      : Factor w/ 3 levels &quot;&quot;,&quot;EXCERPTS&quot;,..: 2 2 2 2 2 2 2 2 2 2 ...
##  $ participant.ID       : Factor w/ 81 levels &quot;&quot;,&quot;003KII&quot;,&quot;004AB&quot;,..: 6 22 30 32 46 48 49 66 67 77 ...
##  $ participant.info     : Factor w/ 39 levels &quot;&quot;,&quot;14830&quot;,&quot;14869&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ participant.birthdate: Factor w/ 62 levels &quot;&quot;,&quot;2011-12-06&quot;,..: 36 28 26 23 21 22 20 18 17 16 ...
##  $ participant.gender   : Factor w/ 3 levels &quot;&quot;,&quot;Female&quot;,&quot;Male&quot;: 3 2 2 3 2 2 3 2 2 3 ...
##  $ condition.name       : Factor w/ 2 levels &quot;&quot;,&quot;motion-stationary&quot;: 2 2 2 2 2 2 2 2 2 2 ...
##  $ context.setting      : Factor w/ 2 levels &quot;&quot;,&quot;Home&quot;: 2 2 2 2 2 2 2 2 2 2 ...
##  $ context.country      : Factor w/ 3 levels &quot;&quot;,&quot;India&quot;,&quot;US&quot;: 2 2 2 2 2 2 2 2 2 2 ...
##  $ context.state        : Factor w/ 3 levels &quot;&quot;,&quot;IN&quot;,&quot;Tamil Nadu&quot;: 3 3 3 3 3 3 3 3 3 3 ...</code></pre>
<p>We note that the Databrary API is inconsisent in using periods <code>.</code> and underscores <code>_</code> in field names. We can clean this before we merge with the other data files and possibly drop some variables that aren’t really useful.</p>
</div>
</div>
<div id="data-cleaning" class="section level1">
<h1><span class="header-section-number">3</span> Data cleaning</h1>
<div id="clean-participants" class="section level2">
<h2><span class="header-section-number">3.1</span> Clean <code>participants</code></h2>
<p>I want to retain <code>participant.ID</code> which will match to <code>ID</code>, <code>participant.gender</code>, and <code>context.country</code>. It’s not essential, but I prefer lower case variable names with underscores as separators. Oddly, an age variable is not downloaded. We can address that later.</p>
<pre class="r"><code>participants &lt;- participants %&gt;%
  select(participant.ID, participant.gender, context.country) %&gt;%
  rename(ID = participant.ID, gender = participant.gender, country = context.country)</code></pre>
</div>
<div id="merge-files" class="section level2">
<h2><span class="header-section-number">3.2</span> Merge files</h2>
<pre class="r"><code>patt_hist &lt;- dplyr::left_join(patt_hist, participants, by = &quot;ID&quot;)</code></pre>
<pre><code>## Warning: Column `ID` joining factors with different levels, coercing to
## character vector</code></pre>
<p>It looks like there may be some inconsistencies in our <code>ID</code> variable.</p>
<div id="diagnosing-issues-with-id" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Diagnosing issues with ID</h3>
<pre class="r"><code>unique(participants$ID)</code></pre>
<pre><code>##  [1] 008KEI 017MAI 024DAI 025TAI 034SAI 036NII 036VII 048REI 048YAI 054AJI
## [11] 058LAI 006AP  009SS  022JL  025TT  034JC  034NW  036MR  046TE  047MS 
## [21] 053KD  057AP         015KRI 024KAI 026SAI 030JOI 037KAI 038ALI 043GOI
## [31] 051SAI 052RDI 003KII 011MOI 013ABI 013SAI 015AKI 015LAI 015THI 018KAI
## [41] 023MMI 026JAI 028KUI 031VAI 037THI 040KRI 043JAI 046YUI 053GII 063NII
## [51] 004AB  011EA  012TT  013LS  014SN  015JM  016TF  019JC  023NF  024AM 
## [61] 026AR  027SS  028CK  030FD  031HW  037SM  038RB  039ED  040ER  044ET 
## [71] 045NA  048KG  049JC  050AB  051DW  053MT  062HW  006MOI 017EW  018MT 
## [81] 049KRI
## 81 Levels:  003KII 004AB 006AP 006MOI 008KEI 009SS 011EA 011MOI ... 063NII</code></pre>
<pre class="r"><code>unique(patt_hist$ID)</code></pre>
<pre><code>##  [1] &quot;006AP&quot; &quot;006MO&quot; &quot;009SS&quot; &quot;017MA&quot; &quot;018MT&quot; &quot;022JL&quot; &quot;024DA&quot; &quot;025TA&quot;
##  [9] &quot;025TT&quot; &quot;034JC&quot; &quot;034NW&quot; &quot;034SA&quot; &quot;036MR&quot; &quot;036NI&quot; &quot;036VI&quot; &quot;046TE&quot;
## [17] &quot;048RE&quot; &quot;048YA&quot; &quot;053KD&quot; &quot;054AJ&quot; &quot;057AP&quot; &quot;058LA&quot;</code></pre>
<pre class="r"><code>unique(spd_bins$ID)</code></pre>
<pre><code>##  [1] 006AP 006MO 009SS 017MA 018MT 022JL 024DA 025TA 025TT 034JC 034NW
## [12] 034SA 036MR 036NI 036VI 046TE 048RE 048YA 053KD 054AJ 057AP 058LA
## 22 Levels: 006AP 006MO 009SS 017MA 018MT 022JL 024DA 025TA 025TT ... 058LA</code></pre>
<pre class="r"><code>unique(spd_fits$ID)</code></pre>
<pre><code>##  [1] 006AP 006MO 009SS 017MA 018MT 022JL 024DA 025TA 025TT 034JC 034NW
## [12] 034SA 036MR 036NI 036VI 046TE 048RE 048YA 053KD 054AJ 057AP 058LA
## 22 Levels: 006AP 006MO 009SS 017MA 018MT 022JL 024DA 025TA 025TT ... 058LA</code></pre>
<p>It appears that we have optic flow data for <span class="math inline">\(n=\)</span> 22 participants, but there are <span class="math inline">\(n=\)</span> 81 total in the repository. This isn’t a problem, but I thought we had more optic flow data to analyze.</p>
</div>
</div>
<div id="merging-the-speed-data-with-participants" class="section level2">
<h2><span class="header-section-number">3.3</span> Merging the speed data with participants</h2>
<pre class="r"><code>spd_bins &lt;- dplyr::left_join(spd_bins, participants, by = &quot;ID&quot;)</code></pre>
<pre><code>## Warning: Column `ID` joining factors with different levels, coercing to
## character vector</code></pre>
<pre class="r"><code>spd_fits &lt;- dplyr::left_join(spd_fits, participants, by = &quot;ID&quot;)</code></pre>
<pre><code>## Warning: Column `ID` joining factors with different levels, coercing to
## character vector</code></pre>
</div>
</div>
<div id="visualization" class="section level1">
<h1><span class="header-section-number">4</span> Visualization</h1>
<div id="plan" class="section level2">
<h2><span class="header-section-number">4.1</span> Plan</h2>
<p>Yiming, this is for you.</p>
</div>
</div>
<div id="analysis" class="section level1">
<h1><span class="header-section-number">5</span> Analysis</h1>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
